<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>[PRML] Chapter8 - Graphical Models (1) - minsoo9506</title><meta name="Description" content="This is My New Hugo Site"><meta property="og:title" content="[PRML] Chapter8 - Graphical Models (1)" />
<meta property="og:description" content="graphical model에 대해 정리하였다." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://minsoo9506.github.io/prml-chap08-1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-29T11:33:01+09:00" />
<meta property="article:modified_time" content="2021-11-29T11:33:01+09:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="[PRML] Chapter8 - Graphical Models (1)"/>
<meta name="twitter:description" content="graphical model에 대해 정리하였다."/>
<meta name="application-name" content="minsoo9506">
<meta name="apple-mobile-web-app-title" content="minsoo9506"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://minsoo9506.github.io/prml-chap08-1/" /><link rel="prev" href="http://minsoo9506.github.io/prml-chap07-1/" /><link rel="next" href="http://minsoo9506.github.io/prml-chap08-2/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "[PRML] Chapter8 - Graphical Models (1)",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/minsoo9506.github.io\/prml-chap08-1\/"
        },"genre": "posts","keywords": "Grphical Model","wordcount":  1716 ,
        "url": "http:\/\/minsoo9506.github.io\/prml-chap08-1\/","datePublished": "2021-11-29T11:33:01+09:00","dateModified": "2021-11-29T11:33:01+09:00","publisher": {
            "@type": "Organization",
            "name": "minsoo9506"},"author": {
                "@type": "Person",
                "name": "minsoo9506"
            },"description": ""
    }
    </script></head>
    <body header-desktop="auto" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="minsoo9506">minsoo9506 study note</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="minsoo9506">minsoo9506 study note</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">[PRML] Chapter8 - Graphical Models (1)</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/minsoo9506" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>minsoo9506</a></span>&nbsp;<span class="post-category">included in <a href="/categories/prml/"><i class="far fa-folder fa-fw"></i>PRML</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-11-29">2021-11-29</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1716 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;9 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="true">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#81-bayesian-networks">8.1 Bayesian Networks</a>
      <ul>
        <li><a href="#811-example--polynomial-regression">8.1.1 Example : Polynomial regression</a></li>
        <li><a href="#812-generative-models">8.1.2 Generative models</a></li>
        <li><a href="#813-discrete-variables">8.1.3 Discrete variables</a></li>
        <li><a href="#814-linear-gaussian-models">8.1.4 Linear-Gaussian models</a></li>
      </ul>
    </li>
    <li><a href="#82-conditional-independence">8.2 Conditional Independence</a>
      <ul>
        <li><a href="#821-three-example-graphs">8.2.1 Three example graphs</a></li>
        <li><a href="#822-d-seperation">8.2.2 D-seperation</a></li>
      </ul>
    </li>
    <li><a href="#83-markov-random-fields">8.3 Markov Random Fields</a>
      <ul>
        <li><a href="#831-conditional-independence-properties">8.3.1 Conditional independence properties</a></li>
        <li><a href="#832-factorization-properties">8.3.2 Factorization properties</a></li>
        <li><a href="#833-image-de-noising">8.3.3 Image de-noising</a></li>
        <li><a href="#834-relation-to-directed-graphs">8.3.4 Relation to directed graphs</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>graphical model에 대해 정리하였다.</p>
<ul>
<li>probabilistic graphical models 의 장점
<ul>
<li>probabilistic model의 구조를 시각화하기 좋다.</li>
<li>model에 대한 insight를 얻을 수 있다.</li>
<li>복잡한 modeling을 graphical적인 방법으로 다룰 수 있다.</li>
</ul>
</li>
</ul>
<p>probabilistic graphical model에서 각 <strong>node</strong>는 random variable을 의미하고 <strong>link</strong>는 그들의 관계를 의미한다. joint distribution이 각 factor들의 product로 decomposed되는 모습을 주로 나타낸다.</p>
<ul>
<li><em>Bayesian network</em> (directed graphical model) : link가 특정한 방향을 가르키는 경우</li>
<li><em>Markov random field</em> (undirecte graphical model) : 방향이 없는 경우</li>
</ul>
<h2 id="81-bayesian-networks">8.1 Bayesian Networks</h2>
<p>먼저 간단한 예시를 보자.</p>
<p>$$p(a,b,c) = p(c|a,b)p(b|a)p(a)$$</p>
<p>위의 식처럼 우리는 <strong>joint distribution을 분해</strong>할 수 있다. 이때 node a는 node b의 <em>parent</em> node라고 부른다. 반대로 node b는 node a의 <em>child</em> node이다. 그리고 link의 방향은 given에서 출발한다. 즉, node a에서 node b로 화살표가 그려지는 것이다. 그리고 이와 같이 (특정순서대로) 모든 node에게서 link를 받으면 이 graph를 <em>fully conneted</em> 하다고 한다. 이를 일반화하면</p>
<p>$$p(\textbf{x}) = \prod_{k=1}^{K}{p(x_k|pa_k)}$$</p>
<p>의 형태이다. $pa_k$는 parent node들을 의미한다. 우리가 다루는 directed graph는 no <em>direted cycle</em> 이라는 제약이 있다. 이는 directed acyclic graph라는 의미로 parent node로 다시 돌아가는 link가 없다는 의미이다.</p>
<h3 id="811-example--polynomial-regression">8.1.1 Example : Polynomial regression</h3>
<p>polynomial regression에서 prediction을 graphical model로 나타내면</p>
<center><img src="../assets/img/chap08-1.jpg" width="50%"></center>
<p>색이 칠해진 $t_n$ 부분은 given의 의미이다.</p>
<h3 id="812-generative-models">8.1.2 Generative models</h3>
<ul>
<li>주어진 probability distribution에서 sampling을 해야하는 경우가 있다. 다양한 방법들 중에 여기서는 graphical model과 관련있는 <em>ancestral sampling</em> 에 대해 알아보자. joint distribution $p(x_1,&hellip;x_k)$에 sampling을 하고자 한다. 우리는 이를 적절한 directed acyclic graph로 factorization할 것이다. 그리고 높은 숫자 node에서 낮은 숫자 node로의 link는 없다고 가정한다.</li>
<li>따라서 먼저 $p(x_1)$에서 sampling을 하고 $\hat{x}_1$이 parent로 있는 conditional distribution에서 sampling을 한다. 이를 반복해서 $p(x_i|pa_i)$을 구하다보면 결국 우리가 원하는 joint distribution에서 sample을 얻는 것과 동일한 결과를 만들 수 있다. 특정 변수의 marginal distribution을 얻고 싶으면 필요한 sample만 쓰면 된다.</li>
<li>probabilistic model에서 주로 higher-numbered node는 observation을 나타내고 lower-numbered node는 주로 latent variable에 해당한다. 이러한 구조를 이용하여 observed data가 만들어지는 과정을 해석할 수 있다.</li>
<li>graphical model는 observed data가 만들어진 <em>causal</em> 과정을 잡을 수 있다. 이러한 이유로 그런 model를 <em>generative</em> model이라고 한다. 앞에서 본 polynomial regression같은 경우는 generative model이 아니다. input $x$과 관련한 probability distribution이 없기 때문이다.</li>
</ul>
<h3 id="813-discrete-variables">8.1.3 Discrete variables</h3>
<p>discrete variable들의 joint distribution을 DAG로 표현해보자. probability distribution $p(\textbf{x}|{\pmb \mu})$ for a single variable $\textbf{x}$이 있다. K개의 states를 가질 수 있다고 하면</p>
<p>$$p(\textbf{x} | {\pmb \mu}) = \prod_{k=1}^{K}{\mu_k^{x_k}}$$</p>
<p>이번에는 2개의 discrete variable의 joint distribution을 modeling한다고 하자.</p>
<p>$$p(\textbf{x} _ 1, \textbf{x} _ 2 | {\pmb \mu}) = \prod_{k=1}^{K} \prod_{l=1}^{K} \mu_{kl}^{x_{1k} x_{2l}}$$</p>
<p>여기서 $\sum_k \sum_l \mu_{kl}=1$이라는 제약식이 있다. 따라서 이 distribution에서 parameter는 $K^2-1$개 이다. M개의 variable의 경우는 $K^M-1$이 될 것이고 이는 상당히 많은 양(exponentially)의 parameter를 요구하는 것이다.</p>
<ul>
<li>만약 variable들이 서로 independent하다면 $M(K-1)$개의 parameter가 필요하다. link를 drop하여 더 간단한 model이 되는 것이다. 대신에 제한적인 distribution을 얻는다.</li>
<li>markov chain과 같은 형태라고 가정하면 필요한 parameter는 $K-1+(M-1)K(K-1)$개 이다.</li>
<li>parameter의 수를 줄이는 또 다른 방법은 parameter를 sharing하는 방법이다. 예를 들어 $p(x_i | x_{i-1})$의 conditional distribution이 모두 동일한 $K(K-1)$개의 parameter를 공유한다고 하면 전체 parameter는 $K-1 + K(K-1)$개가 된다.</li>
<li>또 다른 방법은 parameterized model을 이용하는 것이다. 예를 들어, $p(y=1|x_1,&hellip;,x_M)=\sigma(\textbf{w}^T\textbf{x})$와 같은 형태를 이용하면 필요한 parameter는 $M$에 linear한 갯수가 필요하게 된다.</li>
</ul>
<p>위의 방법들은 probabilistic modeling에서 parameter의 갯수를 줄일 수 있는 방법들이다.</p>
<h3 id="814-linear-gaussian-models">8.1.4 Linear-Gaussian models</h3>
<p>각 node i는 single continuous random variable $x_i$ (Gaussian distribution) 를 나타낸다. 해당 분포의 mean은 parent node들의 linear combination으로 이루어져있다.</p>
<p>$$p(x_i|pa_i) = N(x_i|\sum_{j \in pa_i} w_{ij}x_j + b_i, v_i)$$</p>
<p>log of joint distribution은 log of product of all conditional node 이고 이를 전개하면</p>
<p>$$\ln p(\textbf{x}) = \sum_{i=1}^{D} \ln p(x_i|pa_i) \ = - \sum_{i}^{D} \frac{1}{2v_i} (x_i - \sum_{j \in pa_i}w_{ij}x_j - b_i)^2 + \text{const}$$</p>
<p>여기서 $\textbf{x}$의 quadratic form이라는 것을 알 수 있고 따라서 joint distribution $p(\textbf{x})$은 multivariate gaussian이라는 것을 알 수 있다.</p>
<p>우리는 joint distribution의 mean과 covariance를 recursively 구할 수 있다. 각 variable $x_i$는 아래와 같은 형태를 갖고 있는데</p>
<p>$$x_i = \sum_{j \in pa_i} w_{ij}x_j + b_i + \sqrt{v_i}\epsilon_i$$</p>
<p>$$E[x_i] = \sum_{j \in pa_i} w_{ij} E[x_j] + b_i \ E[\textbf{x}] = (E[x_1], E[x_2],&hellip;,E[x_D])^T$$</p>
<p>따라서 우리는 lowest numbered node에서 시작하여 recusively mean을 구할 수 있다.</p>
<p>이제 covariance를 구해보면</p>
<p>$$cov[x_i, x_j] = E[(x_i-E[x_i])(x_j-E[x_j])]$$
$$=E[(x_i-E[x_i]){ \sum_{k \in pa_j} w_{jk}(x_k-E[x_k])+\sqrt{v_j}\epsilon_j}]$$
$$=\sum_{k \in pa_j}w_{jk}cov[x_i,x_j]+I_{ij}v_j$$</p>
<p>여기서도 똑같이 recusively 구할 수 있다.</p>
<p>따라서 위에서 discrete에서 공부한 것처럼 parameter의 갯수를 줄이는 방법들을 여기에서도 동일하게 적용할 수 있다.</p>
<h2 id="82-conditional-independence">8.2 Conditional Independence</h2>
<p>$$p(a|b,c) = p(a|c)$$</p>
<p>위와 같은 경우 a is conditionally independent of b given c 라고 한다. 이는 아래와 같은 경우도 해당한다.</p>
<p>$$p(a,b|c)=p(a|b,c)p(b|c) = p(a|c)p(b|c)$$</p>
<p>두 가지 버전의 conditional independence 정의이다. 또 다른 notation으로는</p>
<p>$$a \bot b | c $$</p>
<p>conditional independence는 probabilistic model에서 model의 structure와 computation을 단순화한다. joint distribution에서 conditional independence의 특징을 graphical한 차원에서 바로 파악할 수 있다. 이 방법을 <em>d-seperation</em> 이라고 한다.</p>
<h3 id="821-three-example-graphs">8.2.1 Three example graphs</h3>
<p>총 3가지의 경우에 대해 살펴 볼 것이다.</p>
<ul>
<li>tail-to-tail</li>
</ul>
<p>$$p(a,b,c) = p(a|c)p(b|c)p(c)$$</p>
<p>여기서 모든 변수들이 observed되지 않았고 a,b의 independent를 보기 위해 c에 대해 marginalize하면</p>
<p>$$p(a,b) = \sum_c p(a|c)p(b|c)p(c)$$</p>
<p>이는 $p(a)p(b)$로 factorize되지 않는다. 즉 independent하지 않다는 의미이다. 그렇다면 이번에는 c가 given인 상황을 가정해보자.</p>
<p>$$p(a,b|c) = \frac{p(a,b,c)}{p(c)} = \frac{p(a|c)p(b|c)p(c)}{p(c)} = p(a|c)p(b|c)\ \therefore a \bot b | c $$</p>
<ul>
<li>
<p>여기서 node c는 <em>tail-to-tail</em> 이라고 한다.</p>
<ul>
<li>link가 node c에서 node a,b로 간다.</li>
<li>이를 통해 node a와 node b사이의 path가 생긴다.</li>
<li>이는 두 node가 dependent하다는 의미이다.</li>
<li>하지만 node c가 observed되는 순간 (conditioned on c) a와 b사이의 path를 block한다.</li>
<li>그래서 a와 b는 conditionally independent해진다.</li>
</ul>
</li>
<li>
<p>head-to-tail</p>
</li>
</ul>
<p>$$p(a,b,c) = p(a)p(c|a)p(b|c) \\ p(a,b) = p(a)\sum_c p(c|a)p(b|c)=p(a)p(b|a)$$</p>
<p>여기서도 마찬가지로 independent하지 않다. 하지만 c가 given이면</p>
<p>$$p(a,b|c) = \frac{p(a,b,c)}{p(c)} = \frac{p(a)p(c|a)p(b|c)}{p(c)}=p(a|c)p(b|c)$$</p>
<ul>
<li>
<p>여기서 node c는 <em>head-to-tail</em> 이라고 한다.</p>
<ul>
<li>node a에서 b로 가는 사이에 존재한다.</li>
<li>이는 두 node가 dependent하다는 것이다.</li>
<li>하지만 node c가 given되는 순간 두 node의 path는 block된다.</li>
<li>그래서 a와b는 conditionally independent해진다.</li>
</ul>
</li>
<li>
<p>heat-to-head</p>
</li>
</ul>
<p>$$p(a,b,c) = p(a)p(b)p(c|a,b) \\ p(a,b) = p(a)p(b)$$</p>
<p>이번에는 위에 나왔던 내용들과 반대이다. c가 given이 아닌 경우, a와b가 independent하다. 오히려 c가 given이면 independent가 아닌 상태가 된다.</p>
<p>$$p(a,b|c) = \frac{p(a,b,c)}{p(c)} = \frac{p(a)p(b)p(c|a,b)}{p(c)}$$</p>
<ul>
<li>여기서 node c는 <em>head-to-head</em> 이라고 한다.
<ul>
<li>node a,b에서 node c로 화살표가 향하는 형태이다.</li>
<li>node c가 unobserved되면 이는 path를 block한다.</li>
<li>그래서 a와 b는 independent하다.</li>
<li>오히려 c가 observed되면 dependent해진다.</li>
</ul>
</li>
</ul>
<h3 id="822-d-seperation">8.2.2 D-seperation</h3>
<p>위에서 살펴본 3가지의 종류에 따라서 joint distribution을 factorization한다. D-seperation이 특별한 방법론은 아니고 graphical적인 접근으로 conditional independent를 효율적으로 파악하고 이용한다. 책에서는 예시를 통해 이 과정을 설명한다. 책에서는 directed graph를 filter처럼 생각하라고 한다. joint distribution을 filter를 거치게 되면 d-seperation에 따라 conditional independent를 확인하고 factorization까지 한다.</p>
<h2 id="83-markov-random-fields">8.3 Markov Random Fields</h2>
<p><em>Markov random fields</em> (markov network, undirected graphical model)는 link에 방향성이 없는 것이다. 똑같이 각 node들은 a variable or group of variable을 의미하며 link에는 화살표가 없다. 마찬가지로 conditional independence와 fatorization과 관련하여 공부할 것이다.</p>
<h3 id="831-conditional-independence-properties">8.3.1 Conditional independence properties</h3>
<p>위에서 d-seperation을 통해 conditional independence에 대해 파악할 수 있었다. 그런데 head-to-head 때문에 다소 개념이 헷갈리는 부분이 분명 존재한다. 이에 대한 수요로 undirected graphical model이 나오게 되었다.</p>
<p>A,B,C 라는 set of nodes들이 있다고 가정하자. 우리가 궁금한 conditional independence는 아래와 같다.</p>
<p>$$A \bot B | C $$</p>
<p>A에서 C를 거쳐서 B로 가는 모든 길이 block되면 conditional independence가 성립한다. 하나 이상의 길이 존재하면 이는 성립하지 않는다. 즉, 이 조건을 만족하지 않는 어떤 random variable의 분포가 하나라도 있다면 conditional independence라고 할 수 없는 것이다. 다른 시각으로는 C의 모든 node를 없애면서 이와 연결된 link도 없앤 후에 A와 B사이의 path가 존재하지 않는다면 conditional independence하고 할 수 있다.</p>
<h3 id="832-factorization-properties">8.3.2 Factorization properties</h3>
<p>이제 undirected graph에서 factorization rule에 대해 알아보자.</p>
<ul>
<li>two node $x_i,x_j$가 연결되지 않았다고 가정하자.
<ul>
<li>해당 변수들은 conditionally independent given all other nodes</li>
<li>즉, 두 node끼리의 direct path는 없고 indirect path가 지나는 변수들은 observed된 것이다.</li>
</ul>
</li>
</ul>
<p>$$p(x_i,x_j|\textbf{x} _ {-(i,j)})=p(x_i|\textbf{x} _ {-(i,j)})p(x_j|\textbf{x} _ {-i,j})$$</p>
<p>따라서 joint distribution을 factorization하면 두 node i, j는 같은 factor에 속하지 않을 것이다. 여기서 <em>clique</em>의 개념이 나온다.</p>
<ul>
<li>clique
<ul>
<li>subset of the nodes in a graph 이고</li>
<li>모든 node들이 directly 연결되어 있다. (fully connected)</li>
</ul>
</li>
</ul>
<p>따라서 joint distribution을 decomposition할 때 각 factor들이 clique의 변수들로 이루어진 함수들이다.</p>
<ul>
<li>clique를 $C$라고 하고 $\textbf{x}_C$를 해당 clique에 속하는 variable이라고 하자.</li>
<li>joint distribution은 아래와 같이 decomposition할 수 있다.</li>
<li><em>potential functions</em> $\psi_C (\textbf{x}_C)$의 곱으로 이루어져있다.
<ul>
<li>$\psi_C(\textbf{x}_C) \ge 0$</li>
<li>$Z$ 는 normalization constant</li>
<li>아래식은 discrete이라 summation이고 continuous의 경우 integral</li>
</ul>
</li>
</ul>
<p>$$p(\textbf{x}) = \frac{1}{Z} \prod_C \psi_C(\textbf{x} _ C)\\ Z=\sum_{\textbf{x}} \prod_C \psi_C (\textbf{x}_C)$$</p>
<p>directed graph에서는 각 factor들이 conditional distribution given parents의 형태였다. 하지만 여기서 potential function을 선택하는데 있어 제약이 없다. 하지만 그에 반해 normalization constant의 존재가 undirected graph의 가장 큰 한계점이라고 할 수 있다.</p>
<p>factorization과 conditional independence의 관계를 알아보기 위해서는 potential function은 strictly positive한 값을 가진다고 가정한다. 그래서 exponential form을 이용한다.</p>
<p>$$\psi_C(\textbf{x}_C) = \exp{-E(\textbf{x}_C)}$$</p>
<ul>
<li>$E(\textbf{x}_C)$ : <em>energy function</em></li>
<li>위의 식처럼 exponential한 표현을 <em>Boltzmann distribution</em>이라고 한다.</li>
</ul>
<p>joint distribution은 각 potential function의 곱으로 이루어져있으므로 따라서 joint distribution은 각 clique의 energy function의 합으로 이루어지는 것을 의미한다.</p>
<p>directed graph에서의 joint distribution과 다르게 확률적인 해석을 하기 어렵다. 하지만 potential function을 자유롭게 선택할 수 있으며 이는 domain마다 적절하게 선택해야 한다.</p>
<h3 id="833-image-de-noising">8.3.3 Image de-noising</h3>
<p>binary image에서 noise removal을 하는 예시를 살펴보자.</p>
<ul>
<li>noise-free image가 binary pixel $x_i \in {-1,1}$ (unknown)</li>
<li>pixel 일부를 random하게 반대로 바꾸면 noise image의 binary pixel $y_i \in {-1,1}$ (known)</li>
</ul>
<p>이를 통해 clique를 정하여 energy function을 찾아보자. energy function을 작게 만들어야 joint distribution을 커지게 할 수 있다.</p>
<ul>
<li>각 pixel별로 clique를 만들수 있을 것이다. ${x_i, y_i}$로 만들 수 있다.
<ul>
<li>$-\eta x_i y_i$ : 두 변수가 같은 값이면 lower energy, 반대부호이면 higher energy</li>
<li>$\eta &gt; 0$</li>
</ul>
</li>
<li>이번에는 pixel의 바로 옆 neighborhood의 경우 ${x_i,x_j}$
<ul>
<li>$-\beta x_i x_j$ : 두 변수가 같은 값이면 lower energy, 반대부호이면 higher energy</li>
<li>$\beta &gt; 0$</li>
</ul>
</li>
<li>마지막으로 biasing the model toward one particular sign 위해
<ul>
<li>$h x_i$ : pixel i in the noise-free image</li>
</ul>
</li>
</ul>
<p>이를 통해 complete energy function과 joint distribution을 구하면</p>
<p>$$E(\textbf{x},\textbf{y}) = h \sum_i x_i - \beta \sum_{{i,j}} x_i x_j -\eta \sum_i x_i y_i$$</p>
<p>$$p(\textbf{x},\textbf{y}) = \frac{1}{Z} \exp{-E(\textbf{x},\textbf{y})}$$</p>
<p>$\textbf{y}$는 observed value이고 따라서 conditional distribution $p(\textbf{x}|\textbf{y})$을 define할 수 있다. 여기서 우리는 확률을 높이는 $\textbf{x}$를 구해야 할 것이다. 이를 위해 iterative한 방법을 사용할 것인데</p>
<ul>
<li><em>iterated conditional modes</em> 라는 방법이다.
<ul>
<li>$x_i = y_i$로 시작한다.</li>
<li>각 $x_i$ 마다 (-1 or 1로) 값을 바꿔가면서 lower energy를 갖는 값을 선택한다.
<ul>
<li>하나의 $x_i$값을 계산하기 때문에 빠르게 진행할 수 있다.</li>
</ul>
</li>
<li>특정 criterion을 만족할 때까지 반복한다.</li>
</ul>
</li>
</ul>
<p>뒤에서 high probability를 찾는 max-product algorithm에 대해 살펴볼 것이다.</p>
<h3 id="834-relation-to-directed-graphs">8.3.4 Relation to directed graphs</h3>
<p>예시를 통해 둘의 관계에 대해 알아보자.</p>
<p>먼저, MC형태의 directed graph의 joint distribution이 아래와 같다.</p>
<p>$$p(\textbf{x}) = p(x_1)p(x_2 | x_1)&hellip;p(x_N | x_{N-1})$$</p>
<p>이를 undirected graph로 나타내보자. (maximal) clique를 고려하여 joint distribution을 나타내면</p>
<p>$$p(\textbf{x}) = \frac{1}{Z} \psi_{1,2}(x_1, x_2)\psi_{2,3}(x_2, x_3)&hellip;\psi_{N-1,N}(x_{N-1}, x_N)$$</p>
<p>그렇다면 어렵지 않게</p>
<p>$$\psi_{1,2}(x_1, x_2)= p(x_1)p(x_2 | x_2)\ \psi_{2,3}(x_2, x_3)=p(x_3 | x_2) \\ &hellip; \\ \psi_{N-1,N}(x_{N-1}, x_N) = p(x_N | x_{N-1})$$</p>
<p>로 나타낼 수 있을 것이다. conditional distribution에 관련한 variable들을 같은 clique의 멤버로 하면 된다. 또 다른 예시를 보자.</p>
<p>$$p(\textbf{x})=p(x_1)p(x_2)p(x_3)p(x_4 | x_1,x_2,x_3)$$</p>
<p>위와 같은 경우를 undirected graph로 나타내기 위해서는 마지막항으로 인해 원래는 directed graph에는 없던 link를 만들어야한다. (같은 clique에 속하게 해야하니까) 이렇게 &lsquo;marrying parents&rsquo; 하는 과정을 <em>moralization</em>이라고 하며 link를 만들고 arrow를 없애는 과정으로 만들어진 graph를 <em>moral graph</em>라고 한다.</p>
<p>이처럼 directed를 undirected로 바꾸는 과정에서 conditional property를 많이 잃게 된다. 그래서 최대한 이를 지켜주면서 바꾸는게 중요한 듯 하다. 그리고 반대로 undirected에서 directed로 바꾸는 경우는 많지 않다고 한다. 그 이유중 하나는 normalization constant 때문이라고 할 수 있다.</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2021-11-29</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/prml-chap08-1/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/grphical-model/">Grphical Model</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/prml-chap07-1/" class="prev" rel="prev" title="[PRML] Chapter7 - Sparse Kernel Machine"><i class="fas fa-angle-left fa-fw"></i>[PRML] Chapter7 - Sparse Kernel Machine</a>
            <a href="/prml-chap08-2/" class="next" rel="next" title="[PRML] Chapter8 - Graphical Models (2)">[PRML] Chapter8 - Graphical Models (2)<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.101.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/minsoo9506" target="_blank">minsoo9506</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
